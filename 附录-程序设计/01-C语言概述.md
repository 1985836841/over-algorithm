## 一 C 语言简介

#### 1.1 C 语言的发展

1972 年，为了移植与开发`UNIX`操作系统，丹尼斯·里奇(Dennis Ritch)与肯·汤普逊（Ken Thompason，同时也是 Go 语言与 Unix 作者）在贝尔实验室设计开发了`C`语言（以汤普逊的 B 语言为基础）。

C 语言诞生于 1972 年，拥有多个版本：

```txt
C89：诞生于1989年，是第一个C语言草案，由国际标准协会(ANSI)发布，也称为ANSI C。1990年，该标准也被国际标准化组织ISO接受，即国标ISP/IEC 9899。
C99：诞生于1999年，非常重要的版本，添加了C++的一些功能，并于2001年、2004年进行了两次技术修正。
```

1978 年，布莱恩·柯林汉（Brian Kernighan）和丹尼斯·里奇（Dennis Ritchie）制作了`C`的第一个公开可用的描述，现在被称为`K&R`标准。

C 语言没有自己的默认标准库，其 Unix 实现的标准库称为了标准库。

1989 年，ANSI C 标准库公布（83 年开发），且于 1990 年被国际标准组织（ISO）采用，该套标准 ANSI/ISO 的最终版称为 C89 或者 C90。

1999 年，ANSI/ISO 联合委员会发布 C99 标准，C 支持了国际化编程，解决了一些实际缺陷（64 位移植），提高了实用性（科学计算），该标准在 2001 年和 2004 年又进行了修正。

2011 年，C11 标准发布，但并未赢得各大供应商支持。

#### 1.2 C 语言特性

C 语言是一种用途广泛，使用灵活的过程性（procedural）编程语言，其主要特点：

- 语法简洁：共有 37 个关键字，9 种控制语句，使用方便，灵活
- 功能丰富：34 种运算符，多种数据类型
- 结构化控制语句：C 语言是完全模块化和结构化的语言
- 可移植性：在一种系统编写的 C 程序稍微修改（修改头文件）后即可在其他系统运行
- 目标代码质量高：C 本来是为编写系统软件而设计，其目标代码质量高，程序执行效率高
- 支持访问物理地址：C 允许直接访问物理地址，能进行位（bit）操作，能实现汇编语言的大部分功能
- 语法限制不严格：程序设计的自由度很大，比如对数组下标越界不检查，这带来了开发便捷的同时也让编译后的结果出现不确定性，是把双刃剑（所以不要过分依赖 C 编译程序查错）。

#### 1.3 C 语言标准

C 语言是一种通用的、面向过程式的计算机程序设计语言，当前最新的 C 语言标准为 C11 ，在它之前的 C 语言标准为 C99（见 1.1）。

#### 1.4 C 语言应用

C 语言最初是用于系统开发工作，特别是组成操作系统的程序。由于 C 语言所产生的代码运行速度与汇编语言编写的代码运行速度几乎一样，所以采用 C 语言作为系统开发语言，经常用于开发：操作系统，语言编译器，数据库，驱动等。

知名的 C 语言项目：

- PHP：完全由 C 开发的编程语言
- Nginx
- Redis

## 二 C 语言环境搭建

最常用的 C 语言编译器是 GNU 的 C/C++编译器 gcc，查看 gcc 安装情况：

```
# 如果已安装，则会出现提示
gcc -v
```

如果提示未安装，那么需要安装 gcc：

```
Mac：直接下载Xcode即可

Linux：http://gcc.gnu.org/install/

Win：下载MinWG(至少要安装 gcc-core、gcc-g++、binutils 和 MinGW runtime)，并配置环境变量（MinGW 的 bin 子目录到 PATH 环境变量中）
```

## 三 HelloWorld

C 语言文件都是`.c`后缀名结束，创建`hello.c`文件：

```c++
#include <stdio.h>

int main(){

    printf("Hello, World! \n");

    return 0;
}
```

编译与运行：

```
gcc hello.c         # 可以添加参数 -o hello 则会生成名为 hello 的二进制文件
./a.out             # win上生成的程序为 a.exe
```

贴士:

- `#include <stdio.h>` 预处理指令，引入 printf 函数所需要的系统库
- 如果引入本地文件则：`#include "mylib.h"`
- 程序总是从 main 函数开始，即 main 函数是入口函数
- `\n`表示换行
- 每一句都必须带`;`结束
- C 语言的注释支持 `//` 和 `/**/`

## 四 C 程序执行过程

C 程序执行需要四个步骤：

- 1.预编译（预处理）：对预处理指令进行预处理，比如将 HelloWorld 种的`include`部分内容读取出来代替改行文本，删除注释等，此时不检查语法。
- 2.编译：进行语法检查，将预处理后的文件编译为汇编文件
- 3.汇编：将汇编文件生成目标文件（二进制文件）
- 4.连接：把各种依赖库链接到目标文件，最后生成一个**可执行程序**（executive c）。连接工作由连接编辑程序完成（linkage editor）。

我们可以将上一节的 gcc 命令进行按照上述四个步骤详细执行：

```
gcc -E hello.c -o hello.i       # 预处理
gcc -S hello.i -o hello.s       # 编译
gcc -c hello.s -o hello.o       # 汇编
gcc hello.o -o hello            # 链接
```

贴士：`-o` 表示指定生成的文件名

## 五 C 语言编译环境

#### 5.1 UNIX 环境

UNIX 自带

UNIX 可以使用自带的 cc 命令编译 C 源程序，但是该编译器没有跟上标准发展的脚步，已经退出了历史舞台。通常，现在的 UNIX 系统提供的 C 编译器都来自其他源，然后以 cc 命令作为编译器的别名，如下所示：

```
cc main.c
```

Linux 尽量实现了这些标准，c89、cc、gcc 都指向了系统的 C 语言编译器，通常是 GNU C 编译器或 gcc。

#### 5.2 GUN 编译器集合

GNU 编译器现在是包含很多语言的编译器合集，包括 C 的编译器 GCC。GCC 有很多版本以适应不同的硬件平台和操作系统，其调用命令如下：

```
gcc main.c      # 当然许多系统也使用cc作为gcc的别名

// 不同版本的gcc
gcc -std=c99 main.c
gcc -std=c1x main.c
gcc -std=c11 main.c
```

#### 5.3 LLVM

LLVM 是 cc 的另一个替代品，其编译器 Clang 是 FreeBSD 的默认 C 编译器，当然他也使用 cc 别名。

```
cc -v           # 查看版本
```

#### 5.4 PC 下编译 C 语言

C 编译器不是 Windows 软件包的一部分，需要下载类似 Cygwin 或者 MinGW 这样的 GCC 编译器。

当然微软也拥有自己的一套标准：VC++。
